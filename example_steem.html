<script src="dist/beet-js.js"></script>
<script>
beet.init('beet-js example for steem').then(identities => {
    try {
        console.log("identities", identities);
        if (identities.length == 0) {
            beet.connect().then(res => {
                beet.link('STEEM').then(res => {
                    console.log("linked");

                    // comment this back in to debug id mismatch

                    // beet.voteFor({id: '1.14.159'}).then(account => {
                    //     console.log("voteFor", account);
                    // }).catch((err) => {
                    //     console.error("voteFor", err);
                    // });
                }).catch((err) => {
                    console.error(err);
                });
            }).catch((err) => {
                console.error(err);
            });
        } else {
            beet.connect(identities[0]).then(res => {
                console.log("connected", res);
                beet.requestSignature(
                    {
                        type: "customJSON",
                        data: {
                            requiredAuths: [ "sschiessl" ],
                            requiredPostingAuths: [],
                            id: "beet.example",
                            json: {
                                text: "This custom json data was put on Steem with Bett",
                                url: "https://github.com/bitshares/beet"
                            }
                        }
                    }
                ).then(account => {
                    console.log("requestSignature", account);
                }).catch((err) => {
                    console.error("requestSignature", err);
                });
            }).catch((err) => {
                console.error(err);
            });

            // beet.connect(identities[0]).then(res => {
            //     console.log("connected", res);
            //     beet.voteFor(
            //         {
            //             author: "krazykrista",
            //             permlink: "bitshares-scam-do-not-accept-proposed-transactions-that-update-your-account-data",
            //             weight: 1
            //         }
            //     ).then(account => {
            //         console.log("voteFor", account);
            //     }).catch((err) => {
            //         console.error("voteFor", err);
            //     });
            // }).catch((err) => {
            //     console.error(err);
            // });
        }
    } catch (err) {
        console.error(err);
    }
}).catch((err) => {
    console.error(err);
});
</script>